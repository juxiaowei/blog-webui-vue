<!DOCTYPE html>
<html>
<head><title>Mac下安装Docker</title>
    <meta charset='utf-8'>
    <link href='/build/css/md.css' rel='stylesheet'>
    <style></style>
</head>
<body>
<header id="header">
    <div class="article-title">
        Mac下安装Docker
    </div>
    <div class="nav-toggle"><a href="#"><i class="fa fa-bars"></i></a></div>
</header>
<div class="web-content">
<div id='preview-contents' class='note-content'>
    <div id="wmd-preview" class="preview-content"></div>
    <div id="wmd-preview-section-5214" class="wmd-preview-section preview-content"></div>
    <div id="wmd-preview-section-5216" class="wmd-preview-section preview-content">

        <!-- <h3 id="mac下安装homebrew">mac下安装Homebrew</h3> -->

        <p>在终端中输入：</p>

        <p>ruby -e “$(curl -fsSL <a href="https://raw.githubusercontent.com/Homebrew/install/master/install" target="_blank">https://raw.githubusercontent.com/Homebrew/install/master/install</a>)”
        </p>

        <p>如果不是管理用户，需要用sudo命令来执行。 <br>
            安装完成以后，如果在运行 brew install 命令的过程中，出现错误提示： <br>
            /usr/local/bin/brew: line 26: /usr/local/Library/brew.rb: Undefined error: 0。</p>

        <p>输入以下命令进行修复即可：</p>

        <p>cd /usr/local/Library</p>

        <p>git pull origin master</p>

    </div>
    <div id="wmd-preview-section-5217" class="wmd-preview-section preview-content">

        <h3 id="mac下安装docker的管理工具panamax">mac下安装Docker的管理工具Panamax</h3>

        <p>brew install <a href="http://download.panamax.io/installer/brew/panamax.rb" target="_blank">http://download.panamax.io/installer/brew/panamax.rb</a>
            &amp;&amp; panamax init</p>

    </div>
    <div id="wmd-preview-section-5218" class="wmd-preview-section preview-content">

        <h3 id="mac下安装docker">mac下安装Docker</h3>

        <p>mac下通过boot2docker 进行下载安装，其地址为： <br>
            <a href="https://github.com/boot2docker/osx-installer/releases" target="_blank">https://github.com/boot2docker/osx-installer/releases</a>
        </p>

        <p>Docker Hub 为：<a href="https://hub.docker.com/" target="_blank">https://hub.docker.com/</a>， 请注册一个账号，用以管理你的docker image，国内下载 Docker
            HUB 官方的相关镜像可能比较慢，可以使用 docker.cn 镜像</p>

        <p>安装好的下载的boot2docker后，点击启动，当看见To connect the Docker client to the Docker daemon的字样，表示启动完毕。 <br>
            建议将下面关于docker的变量属性设置为环境变量，设置方式为： <br>
            打开 <code>~/.bash_profile</code> 文件，然后在其后面追加docker的变量即可，最后输入<code>source ~/.bash_profile</code> 重置系统的环境变量，是否重置成功，可以输入 echo $XXX的方式
            进行查看。</p>

        <p>启动好的docker ，可以通过以下命令来开发端口的访问权限： <br>
            比如：docker run –rm -i -t -p 80:80 nginx <br>
            再用：boot2docker ip 来获取当前docker的ip <br>
            然后就可以通过该ip＋端口，就可以访问到docker里面运行的nginx了。</p>

        <p>注意在boot2docker里面，默认的用户和密码是:<code>docker/tcuser</code></p>

        <p>在docker中运行image，需要先到docker hub网站选择你需要的image来运行。</p>

    </div>
    <div id="wmd-preview-section-5219" class="wmd-preview-section preview-content">

        <h4 id="docker常用命令">docker常用命令</h4>

        <p>docker ps 显示正在运行的image</p>

        <p>docker ps -a 显示所有运行过的image，通过里面的STATUS字段，可以查看image状态</p>

        <p>docker ps -l 显示刚刚运行的image 信息</p>

        <p>docker run xxx 运行image,如果该image不存在，则其会先自动到docker hub上下载， 加上参数-d表示以后台进程运行，-p表示指定端口映射,如果想容器外，能访问到docker运行的image服务，需要设定-p参数，来对外开放端口，比如
            docker run -d -p 6379:6379 redi 启动后，可以通过boot2docker ip的在外部ip+6379进行访问。</p>

        <p>dokcer stop xxx 根据image ID 来停止某个image。其会有10秒的强杀时间。</p>

        <p>docker run <code>-i -t</code> centos:centos6 <code>/bin/bash</code> 可以通过这个命令运行os的shell,输入exit 则就可以退出该进程,
            -i标志保证容器中STDIN是开启的以提供持久的标准输入是交互式shell，-t标志则告诉Docker为要创建的容器分配一个伪tty终端。这样，新创建的容器才能提供一个交互式shell。</p>

    </div>
    <div id="wmd-preview-section-5220" class="wmd-preview-section preview-content">

        <h3 id="docker需要下载的image">docker需要下载的image</h3>

        <p>docker pull redis <br>
            docker pull mongo <br>
            docker pull mysql <br>
            docker pull nginx <br>
            docker pull node</p>

    </div>
    <div id="wmd-preview-section-5221" class="wmd-preview-section preview-content">

        <h3 id="docker-启动node项目">docker 启动node项目</h3>

        <p>我们可以把源代码放在host上，然后利用docker run -v选项把源代码的文件路径映射到docker container中，这样container就可以直接使用host上的Node代码开启服务。 <br>
            首先你要进入到node的目录中，然后输入以下命令就可以启动。</p>

        <p>docker run -it –rm –name YYY -v “$PWD”:XXX -w XXX node ZZZ</p>

        <p>其中YYY为自定义这次启动的image进程的名字，通过不同的命名，可以启动多个image, <br>
            XXX为映射的路径，ZZZ为执行的node命令。</p>

        <p>比如：docker run -it –rm –name <code>nodeTest</code> -v “$PWD”:<code>/Users/tangnian/WebstormProjects/huodongla</code> -w <code>/Users/tangnian/WebstormProjects/huodongla</code>
            node <code>npm start</code></p>

    </div>
    <div id="wmd-preview-section-5519" class="wmd-preview-section preview-content">

        <h3 id="制作node服务的image">制作node服务的image</h3>

        <p>方式有2种：</p>

        <p>1:一种是run container 的时候通过 -v 参数将 host 文件或目录加载/共享到 container 里。 <br>
            命令为：<code>docker run -v XXX:YYY -i -t ZZZ AAA</code> <br>
            XXX为host上文件地址，YYY为image中地址，ZZZ为image名称，AAA为在image中需要运行的命令 <br>
            如: docker run -v /Users/tangnian/nodeDeveloper/src:/root -i -t easefit/node node /root/huodongla/index.js <br>
            2:制作包含host中node代码的image，然后直接运行该image。 <br>
            对于第二种方式，可以采取以下命令来实现： </p>

        <ol>
            <li rel="1">创建一个新的文件夹，如：mkdir test,进入该目录,并将app放入该目录</li>
            <li rel="2">用命令：touch Dockerfile 创建一个Dockerfile，并在Dockerfile中输入以下配置 属性，如:</li>
        </ol>
    </div>
    <div id="wmd-preview-section-5432" class="wmd-preview-section preview-content">

        <pre class="prettyprint hljs-dark"><code class="hljs dockerfile"><span class="hljs-comment line-number">1.</span><span
                class="hljs-built_in">from</span> node<br><span class="hljs-comment line-number">2.</span><span
                class="hljs-built_in">copy</span> <span class="bash">. /usr/src<br><span
                class="hljs-comment line-number">3.</span></span><span class="hljs-built_in">WORKDIR</span> <span
                class="bash">/usr/src/app<br><span class="hljs-comment line-number">4.</span></span><br></code></pre>

        <p>最后再执行<code>docker build -t XXX</code> . 的命令。其中XXX为新创建的image的名称，注意要用easefit/node 这样的方式来取名。对于创建好的image，可以通过运行 <code>docker rmi
            XX</code>来删除。注意add . /user/src 是将当前目录下面的文件，都添加到/usr/src下面去,所以最后image中的文件路径为/usr/src/app。</p>

        <p>通过运行 docker run -p 8111:8111 XXX npm start 来运行自己创建的node ima###制作node服务的image</p></div>
    <div id="wmd-preview-section-5411" class="wmd-preview-section preview-content">

        <h3 id="dockerfile中添加的参数说明">DockerFile中添加的参数说明</h3>

        <p>FROM 是作为镜像的基础 <br>
            RUN 可以理解为在FROM下来的镜像做一些环境的部署。 <br>
            CMD 是创建容器后，会运行的命令 <br>
            EXPOSE 是暴露的端口 <br>
            MAINTAINER 通知的邮件 <br>
            ADD/COPY 里面2个参数，第一个为需要放进image的data路径，第二个image的路径。注意路径需要为相对路径 <br>
            VOLUME 是本地的路径的映射 <br>
            WORKDIR 是执行的路径，也就是cmd entrypoint执行的路径。 <br>
            比如：</p></div>
    <div id="wmd-preview-section-5225" class="wmd-preview-section preview-content">

        <pre class="prettyprint hljs-dark"><code class="hljs dockerfile"><span class="hljs-comment line-number">1.</span><span
                class="hljs-built_in">FROM</span> centos:centos<span class="hljs-number">6<br><span class="hljs-comment line-number">2.</span></span><span
                class="hljs-comment"># Enable EPEL for Node.js</span><br><span class="hljs-comment line-number">3.</span>RUN rpm -Uvh
            http://download.fedoraproject.org/pub/epel/<span class="hljs-number">6</span>/i386/epel-release-<span class="hljs-number">6</span>-<span
                    class="hljs-number">8</span>.noarch.rpm<br><span class="hljs-comment line-number">4.</span><span class="hljs-comment"># Install Node.js and npm</span><br><span
                    class="hljs-comment line-number">5.</span><span class="hljs-built_in">RUN</span> <span class="bash">yum -y update<br><span
                    class="hljs-comment line-number">6.</span></span><span class="hljs-built_in">RUN</span> <span class="bash">yum install -y npm<br><span
                    class="hljs-comment line-number">7.</span></span><span class="hljs-comment"># Bundle app source</span><br><span
                    class="hljs-comment line-number">8.</span><span class="hljs-built_in">COPY</span> <span class="bash">. /src<br><span
                    class="hljs-comment line-number">9.</span></span><span class="hljs-comment"># Install app dependencies</span><br><span
                    class="hljs-comment line-number">10.</span><span class="hljs-built_in">RUN</span> <span class="bash"><span
                    class="hljs-built_in">cd</span> /src; npm install<br><span class="hljs-comment line-number">11.</span></span><span
                    class="hljs-built_in">EXPOSE</span> <span class="hljs-number">8080</span><br><span
                    class="hljs-comment line-number">12.</span>CMD [<span class="hljs-string">"node"</span>, <span class="hljs-string">"/src/index.js"</span>]<br><span
                    class="hljs-comment line-number">13.</span><br></code></pre>
    </div>
    <div id="wmd-preview-section-footnotes" class="preview-content"></div>
</div>
</div>
<footer id="footer">
    <div class="copyright">© iAmHades - Blog . Article</div>

    <div class="post-back"><a href="#">‹ Back to Index</a></div>
</footer>

</body>
</html>